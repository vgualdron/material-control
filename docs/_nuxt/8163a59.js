(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{464:function(t,e,r){"use strict";r.d(e,"b",(function(){return l})),r.d(e,"a",(function(){return n}));r(100),r(105);var l=function(t,e){return e.includes(t)},n=function(t,e){return-1!==e.indexOf(t)}},468:function(t,e,r){var content=r(491);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(107).default)("cbf49d04",content,!0,{sourceMap:!1})},490:function(t,e,r){"use strict";r(468)},491:function(t,e,r){var l=r(106)(!1);l.push([t.i,"input.transparent-input,input.transparent-input.focus,input.transparent-input:disabled{background-color:transparent!important;border:none!important;box-shadow:transparent!important;padding:0!important;height:auto!important}",""]),t.exports=l},503:function(t,e,r){"use strict";r.r(e);r(14),r(13),r(15),r(16);var l=r(8),n=r(3),o=(r(32),r(34),r(12),r(31),r(42),r(33),r(70),r(11),r(45),r(75),r(119),r(29)),c=r(79),d=r(60),m=r(4),f=r(47),_=r(464);function h(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var y={name:"table-list",data:function(){return{view:"materialSettlement",fields:[{key:"type",label:"Tipo",sortable:!0,class:"text-center"},{key:"date",label:"Fecha",sortable:!0,class:"text-center"},{key:"referral_number",label:"Numero Remisión",sortable:!0,class:"text-center"},{key:"receipt_number",label:"Numero Recibo",sortable:!0,class:"text-center"},{key:"material_name",label:"Material",sortable:!0,class:"text-center"},{key:"origin_supplier",label:"Patio Despacho / Proveedor",sortable:!0,class:"text-center"},{key:"destiny_customer",label:"Patio Recepción / Cliente",sortable:!0,class:"text-center"},{key:"net_weight",label:"Cant. Despacho",sortable:!0,class:"text-center"},{key:"aux_net_weight",label:"Cant. Recepción",sortable:!0,class:"text-center"},{key:"material_price",label:"Valor Unitario",sortable:!0,class:"text-center"},{key:"net_price",label:"Valor Neto",sortable:!0,class:"text-center"},{key:"settle_receipt_weight",label:"Liquidar Cantidad Recibida",sortable:!0,class:"text-center"}],types:[{value:"C",text:"Compra"},{value:"V",text:"Venta"}],type:"C",start_date:null,final_date:null,customer:null,supplier:null,material:null,material_type:"T",showSettlement:!1,showList:!1,observations:"",retention:"2.5",royalties:0,third_settled:"",start_date_settled:null,final_date_settled:null,labelTextFieldRequired:"Campo obligatorio",arrayTiquets:[]}},watch:{materialSettlements:function(t){this.showSettlement=Object(_.a)("".concat(this.view,".settle"),this.userPermisionsGroup),this.showList=Object(_.a)("".concat(this.view,".list"),this.userPermisionsGroup)}},computed:v(v(v(v(v({},Object(o.d)(m.typesCommon.PATH,["userPermisionsGroup"])),Object(o.d)(c.typesMaterialSettlement.PATH,["materialSettlements","materialSettlement"])),Object(o.d)(d.typesThird.PATH,["localeSupplierThirds","localeCustomerThirds"])),Object(o.d)(f.typesMaterial.PATH,["materials"])),{},{items:function(){return this.materialSettlements.data.map((function(t){return v(v({},t),{},{settle_receipt_weight:!1})}))},subtotalWeight:function(){var t,e=0;return this.items.forEach((function(element){t=element.settle_receipt_weight?element.aux_net_weight.toString().replace(/,/g,""):element.net_weight.toString().replace(/,/g,""),e+=parseFloat(t)})),this.formatDecimal(e)},totalValue:function(){var t=0;return this.items.forEach((function(element){t+=parseFloat(element.net_price.toString().replace(/,/g,""))})),this.formatDecimal(t)},subtotalRetention:function(){var t=parseFloat(this.totalValue.toString().replace(/,/g,""))/100*parseFloat(this.retention.toString().replace(/,/g,""));return this.formatDecimal(t)},subtotalRoyalties:function(){var t=parseFloat(this.subtotalWeight.toString().replace(/,/g,""))*parseFloat(this.royalties.toString().replace(/,/g,""));return this.formatDecimal(t)},totalSettle:function(){var t=parseFloat(this.totalValue.toString().replace(/,/g,""))-parseFloat(this.subtotalRetention.toString().replace(/,/g,""))-parseFloat(this.subtotalRoyalties.toString().replace(/,/g,""));return this.formatDecimal(t)},stateType:function(){return!(!this.type||""===this.type)},stateFilterDisabled:function(){return null===this.type||""===this.type||null===this.material_type||""===this.material_type||null===this.start_date||""===this.start_date||null===this.final_date||""===this.final_date||this.final_date<this.start_date||"V"===this.type&&(null===this.customer||""===this.customer)||"C"===this.type&&(null===this.supplier||""===this.supplier)},stateStartDate:function(){return null!==this.start_date&&""!==this.start_date},stateFinalDate:function(){return null!==this.final_date&&""!==this.final_date},stateSupplier:function(){return"C"!==this.type||null!==this.supplier&&""!==this.supplier},stateCustomer:function(){return"V"!==this.type||null!==this.customer&&""!==this.customer},disableButtonSettle:function(){var t=!1;return this.items.forEach((function(element){(null===element.net_price||""===element.net_price||0===parseFloat(element.net_price.toString().replace(/,/g,""))||element.settle_receipt_weight&&!0===element.settle_receipt_weight&&0===parseFloat(element.aux_net_weight.toString().replace(/,/g,"")))&&(t=!0)})),t}}),created:function(){this.searchMaterials(),this.searchInitialThirds()},methods:v(v(v(v({},Object(o.b)(c.typesMaterialSettlement.PATH,{getMaterialSettlements:c.typesMaterialSettlement.actions.GET_MATERIAL_SETTLEMENTS,settle:c.typesMaterialSettlement.actions.SAVE,print:c.typesMaterialSettlement.actions.PRINT})),Object(o.b)(d.typesThird.PATH,{getSupplierThirds:d.typesThird.actions.GET_SUPPLIER_THIRDS,getCustomerThirds:d.typesThird.actions.GET_CUSTOMER_THIRDS})),Object(o.b)(f.typesMaterial.PATH,{getMaterials:f.typesMaterial.actions.GET_MATERIALS})),{},{search:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var r,l,n,o,c,d,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.retention="2.5",t.royalties=0,t.observations="",e.next=5,t.getMaterialSettlements({type:t.type,startDate:t.start_date,finalDate:t.final_date,material:t.material,material_type:t.material_type,third:"C"===t.type?t.supplier:t.customer});case 5:t.third_settled="C"===t.type?(null===(r=t.localeSupplierThirds)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.filter((function(e){return e.id===t.supplier})).map((function(t){return t.nit}))[0])+"/"+(null===(n=t.localeSupplierThirds)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.filter((function(e){return e.id===t.supplier})).map((function(t){return t.name}))[0]):(null===(c=t.localeCustomerThirds)||void 0===c||null===(d=c.data)||void 0===d?void 0:d.filter((function(e){return e.id===t.customer})).map((function(t){return t.nit}))[0])+"/"+(null===(m=t.localeCustomerThirds)||void 0===m||null===(f=m.data)||void 0===f?void 0:f.filter((function(e){return e.id===t.customer})).map((function(t){return t.name}))[0]),t.start_date_settled=t.start_date,t.final_date_settled=t.final_date;case 8:case"end":return e.stop()}}),e)})))()},searchThirds:function(t){var data={type:"C"===this.type?"ASOCIADO":"CLIENTE",movement:this.type,start_date:this.start_date,final_date:this.final_date};"C"===this.type?this.getSupplierThirds(data):this.getCustomerThirds(data)},searchInitialThirds:function(t){this.getSupplierThirds({type:"ASOCIADO"});this.getCustomerThirds({type:"CLIENTE"})},formatDecimal:function(t){return"."===t||"0."===t?"0.":null===(t=(t=(t=null===t||""===t.toString().trim()||"-"===t.toString().trim()?0:t).toString().replace(/[^0-9.-]/g,"")).toString())||""===t||0===parseFloat(t)?0:(t=(t="0."===t.substring(0,2)?t:t.replace(/^0+/,"")).replace(/[^0-9.-]/g,""),t=(t=(t=parseFloat(t)<0?-1*parseFloat(t):t).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))},recalculateValues:function(t,e){if("V"===e)this.items[t].net_price=this.formatDecimal(this.items[t].material_price);else{var r=parseFloat(this.items[t].net_weight.toString().replace(/,/g,""))*parseFloat(this.items[t].material_price.toString().replace(/,/g,""));this.items[t].net_price=this.formatDecimal(r)}},cleanFiltersStartDate:function(t){this.final_date=null,this.customer=null,this.supplier=null,"T"===t&&(this.start_date=null)},searchMaterials:function(t){var data={text:t,material:this.material,loaderState:!1};this.getMaterials(data)},save:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.arrayTiquets=[],t.items.forEach((function(element){var e={id:element.id,net_value:parseFloat(element.net_price.toString().replace(/,/g,"")),settle_receipt_weight:element.settle_receipt_weight,weight_settled:element.settle_receipt_weight?element.aux_net_weight:element.net_weight,unit_value:parseFloat(element.material_price.toString().replace(/,/g,""))};t.arrayTiquets.push(e)})),e.next=4,t.settle({tiquets:t.arrayTiquets,type:"M",retentionPercentage:parseFloat(t.retention.toString().replace(/,/g,"")),retention:parseFloat(t.subtotalRetention.toString().replace(/,/g,"")),royalties:parseFloat(t.subtotalRoyalties.toString().replace(/,/g,"")),royaltiesBase:parseFloat(t.royalties.toString().replace(/,/g,"")),subtotalSettle:parseFloat(t.totalValue.toString().replace(/,/g,"")),subtotalWeight:parseFloat(t.subtotalWeight.toString().replace(/,/g,"")),totalSettle:parseFloat(t.totalSettle.toString().replace(/,/g,"")),third:t.third_settled,startDate:t.start_date_settled,finalDate:t.final_date_settled,observations:t.observations});case 4:null!==t.materialSettlement&&t.printReport();case 5:case"end":return e.stop()}}),e)})))()},printReport:function(){this.print(this.materialSettlement)}})},S=(r(490),r(69)),component=Object(S.a)(y,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",{attrs:{title:"Liquidar Material","sub-title":"Opción Para Liquidacion de Material"}},[r("b-form-group",{staticClass:"mb-1"},[r("b-form-row",[r("b-col",{attrs:{md:"4"}},[r("label",{staticClass:"mb-0",attrs:{for:"feedback-type"}},[t._v("Tipo")]),t._v(" "),r("b-form-select",{attrs:{id:"feedback-type",options:t.types},on:{input:function(e){return t.cleanFiltersStartDate("T")}},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}}),t._v(" "),r("b-form-invalid-feedback",{attrs:{state:t.stateType}},[t._v("\n            "+t._s(t.labelTextFieldRequired)+"\n          ")])],1),t._v(" "),r("b-col",{attrs:{md:"4"}},[r("label",{staticClass:"mb-0",attrs:{for:"feedback-start-date"}},[t._v("Fecha Inicial")]),t._v(" "),r("b-form-datepicker",{attrs:{id:"feedback-start-date",placeholder:"Seleccione la Fecha Inicial",max:t.final_date},on:{input:t.cleanFiltersStartDate},model:{value:t.start_date,callback:function(e){t.start_date=e},expression:"start_date"}}),t._v(" "),r("b-form-invalid-feedback",{attrs:{state:t.stateStartDate}},[t._v("\n            "+t._s(t.labelTextFieldRequired)+"\n          ")])],1),t._v(" "),r("b-col",{attrs:{md:"4"}},[r("label",{staticClass:"mb-0",attrs:{for:"feedback-final-date"}},[t._v("Fecha Final")]),t._v(" "),r("b-form-datepicker",{attrs:{id:"feedback-final-date",placeholder:"Seleccione la Fecha Final",min:t.start_date},on:{input:t.searchThirds},model:{value:t.final_date,callback:function(e){t.final_date=e},expression:"final_date"}}),t._v(" "),r("b-form-invalid-feedback",{attrs:{state:t.stateFinalDate}},[t._v("\n            "+t._s(t.labelTextFieldRequired)+"\n          ")])],1)],1),t._v(" "),r("b-form-row",["C"==t.type?r("b-col",{attrs:{md:"4"}},[r("label",{staticClass:"mb-0",attrs:{for:"feedback-supplier"}},[t._v("Proveedor")]),t._v(" "),t.localeSupplierThirds&&t.localeSupplierThirds.data?r("v-select",{attrs:{id:"feedback-supplier",required:"",options:t.localeSupplierThirds.data,label:"name",reduce:function(data){return data.id}},model:{value:t.supplier,callback:function(e){t.supplier=e},expression:"supplier"}}):t._e(),t._v(" "),r("b-form-invalid-feedback",{attrs:{state:t.stateSupplier}},[t._v("\n            "+t._s(t.labelTextFieldRequired)+"\n          ")])],1):t._e(),t._v(" "),"V"==t.type?r("b-col",{attrs:{md:"4"}},[r("label",{staticClass:"mb-0",attrs:{for:"feedback-customer"}},[t._v("Cliente")]),t._v(" "),t.localeCustomerThirds&&t.localeCustomerThirds.data?r("v-select",{attrs:{id:"feedback-customer",required:"",options:t.localeCustomerThirds.data,label:"name",reduce:function(data){return data.id}},model:{value:t.customer,callback:function(e){t.customer=e},expression:"customer"}}):t._e(),t._v(" "),r("b-form-invalid-feedback",{attrs:{state:t.stateCustomer}},[t._v("\n            "+t._s(t.labelTextFieldRequired)+"\n          ")])],1):t._e(),t._v(" "),r("b-col",{attrs:{md:"4"}},[r("label",{staticClass:"mb-0",attrs:{for:"feedback-material"}},[t._v("Material")]),t._v(" "),t.materials&&t.materials.data?r("v-select",{attrs:{filterable:!1,id:"feedback-material",size:"lg",required:"",options:t.materials.data,label:"name",reduce:function(data){return data.id}},on:{search:t.searchMaterials},model:{value:t.material,callback:function(e){t.material=e},expression:"material"}}):t._e()],1),t._v(" "),r("b-col",{attrs:{md:"4"}},[r("label",{staticClass:"mb-0",attrs:{for:"feedback-material-type"}},[t._v("Tipo de material")]),t._v(" "),r("b-form-radio-group",{staticClass:"mt-1",attrs:{id:"feedback-material-type"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.ariaDescribedby;return[r("b-form-radio",{attrs:{"aria-describedby":l,name:"material_type",value:"T"}},[t._v("Por Tonelada")]),t._v(" "),r("b-form-radio",{attrs:{"aria-describedby":l,name:"material_type",value:"U"}},[t._v("Por Viaje")])]}}]),model:{value:t.material_type,callback:function(e){t.material_type=e},expression:"material_type"}})],1)],1)],1),t._v(" "),r("b-button",{staticClass:"mt-2 mb-2",attrs:{disabled:t.stateFilterDisabled},on:{click:t.search}},[t._v("Filtrar")]),t._v(" "),t.showList?[r("b-table",{attrs:{striped:!0,bordered:!0,hover:!0,fixed:!0,items:t.items,fields:t.fields,stacked:"md","show-empty":"",small:""},scopedSlots:t._u([{key:"cell(aux_net_weight)",fn:function(e){return["T"===e.item.material_unit&&"V"===e.item.type_code&&e.item.settle_receipt_weight?r("b-form-input",{staticClass:"transparent-input text-center",attrs:{disabled:!e.item.settle_receipt_weight||"T"==e.item.type_code,formatter:t.formatDecimal},model:{value:e.item.aux_net_weight,callback:function(r){t.$set(e.item,"aux_net_weight",r)},expression:"row.item.aux_net_weight"}}):t._e()]}},{key:"cell(material_price)",fn:function(e){return[r("b-form-input",{staticClass:"transparent-input text-center",attrs:{formatter:t.formatDecimal},on:{input:function(r){return t.recalculateValues(e.index,e.item.type_code)}},model:{value:e.item.material_price,callback:function(r){t.$set(e.item,"material_price",r)},expression:"row.item.material_price"}})]}},{key:"cell(settle_receipt_weight)",fn:function(e){return["V"===e.item.type_code&&"U"!==e.item.material_unit?r("b-form-checkbox",{model:{value:e.item.settle_receipt_weight,callback:function(r){t.$set(e.item,"settle_receipt_weight",r)},expression:"row.item.settle_receipt_weight"}}):t._e()]}},t.items&&t.items.length>0?{key:"custom-foot",fn:function(){return[r("tr",[r("td",{staticClass:"text-right font-weight-bold",attrs:{colspan:"7"}},[t._v("\n            SUBTOTAL\n          ")]),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}},[r("b-form-input",{staticClass:"transparent-input  text-center",attrs:{formatter:t.formatDecimal,disabled:!0},model:{value:t.subtotalWeight,callback:function(e){t.subtotalWeight=e},expression:"subtotalWeight"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}},[r("b-form-input",{staticClass:"transparent-input  text-center",attrs:{formatter:t.formatDecimal,disabled:!0},model:{value:t.totalValue,callback:function(e){t.totalValue=e},expression:"totalValue"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}})]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold",attrs:{colspan:"7"}},[t._v("\n            RETENCION EN LA FUENTE\n          ")]),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}},[r("b-form-input",{staticClass:"text-center",attrs:{formatter:t.formatDecimal},model:{value:t.retention,callback:function(e){t.retention=e},expression:"retention"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}},[r("b-form-input",{staticClass:"transparent-input text-center",attrs:{formatter:t.formatDecimal,disabled:!0},model:{value:t.subtotalRetention,callback:function(e){t.subtotalRetention=e},expression:"subtotalRetention"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}})]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold",attrs:{colspan:"7"}},[t._v("\n            REGALIAS\n          ")]),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}},[r("b-form-input",{staticClass:"text-center",attrs:{formatter:t.formatDecimal},model:{value:t.royalties,callback:function(e){t.royalties=e},expression:"royalties"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}},[r("b-form-input",{staticClass:"transparent-input text-center",attrs:{formatter:t.formatDecimal,disabled:!0},model:{value:t.subtotalRoyalties,callback:function(e){t.subtotalRoyalties=e},expression:"subtotalRoyalties"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}})]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold",attrs:{colspan:"7"}},[t._v("\n            TOTAL\n          ")]),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}}),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}},[r("b-form-input",{staticClass:"transparent-input text-center",attrs:{formatter:t.formatDecimal,disabled:!0},model:{value:t.totalSettle,callback:function(e){t.totalSettle=e},expression:"totalSettle"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"1"}})]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold",attrs:{colspan:"7"}},[t._v("\n            OBSERVACIONES\n          ")]),t._v(" "),r("td",{staticClass:"font-weight-bold",attrs:{colspan:"4"}},[r("b-form-textarea",{attrs:{placeholder:"Escriba sus observaciones",rows:"3",maxLength:"200"},model:{value:t.observations,callback:function(e){t.observations=e},expression:"observations"}})],1),t._v(" "),r("td",{staticClass:"font-weight-bold text-center align-middle",attrs:{colspan:"1"}},[t.showSettlement?r("b-button",{attrs:{disabled:t.disableButtonSettle},on:{click:function(e){return t.save()}}},[t._v("Liquidar")]):t._e()],1)])]},proxy:!0}:null],null,!0)})]:t._e()],2)}),[],!1,null,null,null);e.default=component.exports}}]);